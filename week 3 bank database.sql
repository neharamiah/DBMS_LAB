create database if not exists bank_database;
show databases;
use bank_database;
create table branch(branch_name varchar(20) primary key, branch_city varchar(20), assets int);
insert into branch values('sbi-hanumanthnagar', "bengaluru",200000);
insert into branch values('sbi-krnagar', 'bengaluru',345678);
insert into branch values('sbi-ramnagar','kolkata',787877);
insert into branch values('sbi-rrnagar','BENGALURU',7136253);
insert into branch values('sbi-VVnagar','BENGALURU',74656567);

create table  bank_account(account_num varchar(20) primary key, branch_name varchAR(20),BALANCE INT,FOREIGN KEY(BRANCH_NAME) REFERENCES bRANCH(BRANCH_NAME) ON DELETE CASCADE);
insert into BANK_ACCOUNT values('234566','sbi-hanumanthnagar',5555);
insert into BANK_ACCOUNT values('43566','sbi-ramnagar',617181);
insert into BANK_ACCOUNT values('244556','sbi-ramnagar',10000);
insert into BANK_ACCOUNT values('367644','sbi-ramnagar',220000);
insert into BANK_ACCOUNT values('5432','sbi-ramnagar',80000);

CREATE TABLE BANK_CUSTOMER(CUSTOMER_NAME VARCHAR(20) PRIMARY KEY, CUSTOMER_STREET VARCHAR(20), CITY VARCHAR(20));
INSERT INTO BANK_CUSTOMER VALUES('RIYA','DVG ROAD', 'BENGALURU');
INSERT INTO BANK_CUSTOMER VALUES('ROHAN','TR STREET','KOLKATA');
INSERT INTO BANK_CUSTOMER VALUES('REENA','RR ROAD','BENGALURU');
INSERT INTO BANK_CUSTOMER VALUES('MOHIT','KR ROAD','BENGALURU');
INSERT INTO BANK_CUSTOMER VALUES('TINA','VV ROAD','BENGALURU');

CREATE TABLE DEPOSITOR(CUSTOMER_NAME VARCHAR(20),ACCOUNT_NUM VARCHAR(20), FOREIGN KEY(CUSTOMER_NAME) REFERENCES BANK_CUSTOMER(CUSTOMER_NAME) ON DELETE CASCADE, FOREIGN KEY(ACCOUNT_NUM) REFERENCES BANK_ACCOUNT(ACCOUNT_NUM) ON DELETE CASCADE);
INSERT INTO DEPOSITOR VALUES('RIYA', '234566');
INSERT INTO DEPOSITOR VALUES('ROHAN','43566');
INSERT INTO DEPOSITOR VALUES('REENA','244556');

CREATE TABLE LOAN(LOAN_NUMBER VARCHAR(20) PRIMARY KEY,BRANCH_NAME VARCHAR(20), AMOUNT VARCHAR(20), FOREIGN KEY(BRANCH_NAME) REFERENCES BRANCH(BRANCH_NAME) ON DELETE CASCADE);
INSERT INTO LOAN VALUES('1234','sbi-hanumanthnagar', '100000');
INSERT INTO LOAN VALUES('2345','sbi-hanumanthnagar','300000');
INSERT INTO LOAN VALUES('7654','sbi-ramnagar','55000');

SELECT * FROM BRANCH;
SELECT * FRom BANK_ACCOUNT;
SELECT * FROM BANK_CUSTOMER;
SELECT * FROM DEPOSITOR;
SELECT * FROM LOAN;

SELECT BRANCH_NAME , ASSETS/100000 AS ASSETS_IN_LAKHS FROM BRANCH;

SELECT CUSTOMER_NAME, BRANCH_NAME FROM DEPOSITOR
JOIN BANK_ACCOUNT USING(ACCOUNT_NUM) GROUP BY CUSTOMER_NAME, BRANCH_NAME HAVING COUNT(ACCOUNT_NUM) > 1;

CREATE VIEW SUM AS
SELECT BRANCH_NAME, SUM(AMOUNT) FROM LOAN GROUP BY BRANCH_NAME;

SELECT * FROM SUM;





